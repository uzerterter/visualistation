<!DOCTYPE html>
<meta charset="utf-8">
<script src="http://d3js.org/d3.v3.min.js"></script>

<style>
    body {
        margin: 0;
        padding: 0;
        overflow: hidden;
    }

    svg {
        width: 100vw; /* 100% of viewport width */
        height: 100vh; /* 100% of viewport height */
        background: #EAE2B7;
    }

    /* Default state style */
    .state {
        fill: #FCBF49;
        stroke: #fff;
        stroke-width: 1.25px;
        opacity: 0.85;
    }

    /* Hover state style for individual states */
    .state:hover {
        fill: #F77F00;
    }

    .state.active {
        fill: #F77F00;
    }

</style>

<body>

    <div id="map"></div>

    <script>
        var width = 1650,
            height = 920,
            margin = { top: 0, left: 0, right: 0, bottom: 0 },
            geoPath;

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .attr("margin", margin);

        var g = svg.append("g")
            .append("g")
            .attr("id", "states");

        var focused = null;

        d3.json("./dataBundesLander.json", function (collection) {

            var bounds = d3.geo.bounds(collection),
                bottomLeft = bounds[0],
                topRight = bounds[1],
                rotLong = -(topRight[0] + bottomLeft[0]) / 2,
                center = [(topRight[0] + bottomLeft[0]) / 2 + rotLong, (topRight[1] + bottomLeft[1]) / 2],

                // Default scale projection
                projection = d3.geo.albers()
                    .parallels([bottomLeft[1], topRight[1]])
                    .rotate([rotLong, 0, 0])
                    .translate([width / 2, height / 2])
                    .center(center),

                bottomLeftPx = projection(bottomLeft),
                topRightPx = projection(topRight),
                scaleFactor = 1.00 * Math.min(width / (topRightPx[0] - bottomLeftPx[0]), height / (-topRightPx[1] + bottomLeftPx[1])),

                projection = d3.geo.albers() // Size of the map
                    .parallels([bottomLeft[1], topRight[1]])
                    .rotate([rotLong, 0, 0])
                    .translate([width / 2, height / 2])
                    .scale(scaleFactor * 1000)
                    .center(center);

            geoPath = d3.geo.path().projection(projection);

            g.selectAll("path.feature") // Necessary
                .data(collection.features)
                .enter()
                .append("path")
                .attr("class", "state")
                .attr("d", geoPath)
                .on("click", function(d) {
                    clickPath(d); // Call clickPath function when a path is clicked
                });
        });

        function clickPath(d) {
            if (focused === d) {
                // If the same state is clicked again, reset the zoom
                resetZoom();
            } else {
                // Calculate the new scale and translate values
                var centroid = geoPath.centroid(d),
                    x = +centroid[0],
                    y = +centroid[1],
                    k = 1.4;   // scaling factor
                focused = d;

                // Apply the zoom transform to the map
                g.transition()
                    .duration(1000)
                    .attr("transform", "translate(" + (width / 2) + "," + (height / 2) + ")scale(" + k + ")translate(" + (-x) + "," + (-y) + ")")
                    .style("stroke-width", 1.75 / k + "px");
            }
            

            // Handle other actions related to the state click here
            g.selectAll("path")
            .classed("active", focused && function (d) { return d === focused; });
        }

        function resetZoom() {
            focused = null;

            // Reset the zoom transform to its initial state
            g.transition()
                .duration(1000)
                .attr("transform", "scale(" + 1 + ")translate(" + 0 + "," + 0 + ")")
                .style("stroke-width", "1px");
        }
    </script>

</body>
</html>
